<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_1755675_laptop_0.ExcelToMRVSUtils</api_name>
        <caller_access/>
        <client_callable>true</client_callable>
        <description/>
        <mobile_callable>false</mobile_callable>
        <name>ExcelToMRVSUtils</name>
        <sandbox_callable>true</sandbox_callable>
        <script><![CDATA[var ExcelToMRVSUtils = Class.create();
ExcelToMRVSUtils.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {
	excelToMRVS : function() {
		// attachment sys id
		var attSysid = this.getParameter('sysparm_attachment');
		
		var parserUtil = new sn_impex.GlideExcelParser(); 
		var attachment = new GlideSysAttachment();
		// use attachment sys id of an excel file
		var attachmentStream = attachment.getContentStream(attSysid);
		parserUtil.parse(attachmentStream);
		//parser.setSource(attachmentStream); 

		//retrieve the column headers
		var headers = parserUtil.getColumnHeaders();  
		var header1 = headers[0];
		var header2 = headers[1];
		var header3 = headers[2];

		var mvrsArray = [];
		while(parserUtil.next()) { 
			var row = parserUtil.getRow(); 

			var mvrsValue = {
				'laptop_type': row[header1],
				'requested_for_whom': row[header2],
				'requirements': row[header3]
			};

			mvrsArray.push(mvrsValue);
			//print row value for both columns   
			// gs.print(row[header1] + ' ' + row[header2] + ' ' + row[header3]);
		}
		return JSON.stringify(mvrsArray);
	},
    type: 'ExcelToMRVSUtils'
});]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-06-11 16:19:59</sys_created_on>
        <sys_id>d32ab8cac30e22106a8050e1b40131a7</sys_id>
        <sys_mod_count>11</sys_mod_count>
        <sys_name>ExcelToMRVSUtils</sys_name>
        <sys_package display_value="Laptop Request" source="x_1755675_laptop_0">337ada5547c22e108762a22f316d43a2</sys_package>
        <sys_policy/>
        <sys_scope display_value="Laptop Request">337ada5547c22e108762a22f316d43a2</sys_scope>
        <sys_update_name>sys_script_include_d32ab8cac30e22106a8050e1b40131a7</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-06-12 08:48:51</sys_updated_on>
    </sys_script_include>
</record_update>
